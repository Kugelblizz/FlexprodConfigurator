<div class="page-layout blank p-24" fusePerfectScrollbar>

  <div class="header mat-accent-bg p-16 p-sm-24" fxLayout="column" fxLayoutAlign="center center">
    <h1>Task</h1>
  </div>

  <div class="content p-24 mat-white-bg" fusePerfectScrollbar>

    <div *ngIf="!isEditMode()" class="mat-white-bg mat-elevation-z4 p-24 mr-24 mb-24"
         fxLayout="column" fxLayoutAlign="start" fxFlex="1 0 auto">
      <mat-form-field fxFlex="100">
        <mat-select placeholder="Task Template">
          <mat-option *ngFor="let taskTemplate of taskTemplates" [value]="taskTemplate"
                      (onSelectionChange)="prefillForm($event, taskTemplate)">
            {{ taskTemplate.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <form form class="mat-white-bg mat-elevation-z4 p-24 mr-24 mb-24" fxLayout="column" fxLayoutAlign="start"
          fxFlex="1 0 auto" name="form" (submit)="save()" [formGroup]="taskForm">
      <div fxLayout="row wrap" fxLayoutAlign="start center" fxFlex="1 0 auto">

        <mat-form-field fxFlex="100">
          <input matInput placeholder="Name" formControlName="name" [readonly]="isEditMode()">
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <textarea matInput placeholder="Description" formControlName="description" rows="10"
                    [readonly]="isEditMode()"></textarea>
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <mat-select placeholder="Project" formControlName="project" [disabled]="isEditMode()">
            <mat-option *ngFor="let project of projects" [value]="project">{{project.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <mat-select placeholder="Workflow Type" formControlName="workflowType" [disabled]="isEditMode()">
            <mat-option *ngFor="let workflowType of workflowTypes" [value]="workflowType">{{workflowType.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <mat-select placeholder="Required Competences" formControlName="requiredCompetences" multiple
                      [disabled]="isEditMode()">
            <mat-option *ngFor="let competence of competences" [value]="competence">{{competence.name}}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <mat-select placeholder="Acquirable Competences" formControlName="acquirableCompetences" multiple
                      [disabled]="isEditMode()">
            <mat-option *ngFor="let competence of competences" [value]="competence">{{competence.name}}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <input matInput [matDatepicker]="startDatePicker" placeholder="Start Date" formControlName="startDate">
          <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
          <mat-datepicker #startDatePicker></mat-datepicker>
        </mat-form-field>

        <mat-form-field fxFlex="100">
          <input matInput [matDatepicker]="endDatePicker" placeholder="End Date" formControlName="endDate">
          <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
          <mat-datepicker #endDatePicker></mat-datepicker>
        </mat-form-field>

        <div class="alert alert-danger" fxFlex="100" *ngIf="taskForm.getError('duplactedCompetence')">
          <span>Required and acquirable competences can't contain the same competence!</span>
        </div>

        <button type="submit" mat-raised-button color="primary">Save</button>
      </div>
    </form>
  </div>
</div>

