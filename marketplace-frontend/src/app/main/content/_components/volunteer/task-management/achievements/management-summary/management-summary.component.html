<div id="achievements" class="page-layout blank p-24" fusePerfectScrollbar>
  <div
    class="header-management-summary p-16 p-sm-24"
    fxLayout="row"
    fxLayoutAlign="center center"
  >
    <h1>Mein FreiwilligenÜBERBLICK</h1>
  </div>

  <!-- HEADER END -->
  <div *ngIf="(tenantMap | keyvalue)?.length">
    <div style="height: 20px;"></div>

    <div *ngIf="classInstanceDTOs.length != 0">
      <div fxLayout="row wrap" fxLayoutAlign="space-around">
        <div *ngFor="let tenant of tenantMap | keyvalue">
          <div fxLayout="column" style="width: 100%;">
            <h2 style="font-size: 30px;">{{ tenant.value.name }}</h2>
            <div fxLayout="row">
              <img
                src="{{ 'data:image/png;base64,' + tenant.value.image }}"
                class="img"
              />
              <table class="table">
                <tbody>
                  <tr>
                    <td>Homepage:</td>
                    <td>{{ tenant.value.homepage }}</td>
                  </tr>
                  <tr>
                    <td>Mitglied seit:</td>
                    <td>{{ getMemberSince(tenant.value.id) }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- LOGOS END -->

    <div style="height: 10px;"></div>
    <p *ngIf="timeout && !isLocalRepositoryConnected" class="alert alert-info">
      <i class="fas fa-exclamation-circle"></i> &nbsp; Lokaler Freiwilligenpass
      nicht erreichbar, deshalb stammen die Daten vom Marktplatz!
    </p>

    <!-- CHARTS BEGINN -->
    <div style="height: 30px;"></div>
    <div *ngIf="timeout && classInstanceDTOs.length > 0">
      <h1 class="engagement">Engagement gesamt</h1>
      <div fxLayout="column" fxLayoutAlign="start center" style="width: 100%;">
        <div fxLayout="column" fxLayoutAlign="start center">
          <div>
            <div
              class="donut-parent-duration"
              *ngIf="durationTotal.length != 0"
            >
              <ngx-charts-advanced-pie-chart
                class="chart-container"
                [results]="durationTotal"
                [animations]="animations"
                [tooltipDisabled]="false"
                [customColors]="colors"
                [valueFormatting]="valueFormattingDuration"
              >
              </ngx-charts-advanced-pie-chart>
            </div>
          </div>
          <div>
            <div class="donut-parent-duration" *ngIf="numberTotal.length != 0">
              <ngx-charts-advanced-pie-chart
                class="chart-container"
                [results]="numberTotal"
                [animations]="animations"
                [tooltipDisabled]="false"
                [customColors]="colors"
                [valueFormatting]="valueFormattingNumber"
              >
              </ngx-charts-advanced-pie-chart>
            </div>
          </div>
        </div>

        <div style="height: 50px;"></div>

        <h1 class="engagement">Engagement {{ 2019 }}</h1>
        <div fxLayout="column" fxLayoutAlign="start center">
          <div>
            <div
              class="donut-parent-duration"
              *ngIf="durationLastYear.length != 0"
            >
              <ngx-charts-advanced-pie-chart
                class="chart-container"
                [results]="durationLastYear"
                [animations]="animations"
                [tooltipDisabled]="false"
                [customColors]="colors"
                [valueFormatting]="valueFormattingDuration"
              >
              </ngx-charts-advanced-pie-chart>
            </div>
          </div>
          <div>
            <div
              class="donut-parent-duration"
              *ngIf="numberLastYear.length != 0"
            >
              <ngx-charts-advanced-pie-chart
                class="chart-container"
                [results]="numberLastYear"
                [animations]="animations"
                [tooltipDisabled]="false"
                [customColors]="colors"
                [valueFormatting]="valueFormattingNumber"
              >
              </ngx-charts-advanced-pie-chart>
            </div>
          </div>
        </div>
      </div>

      <div style="height: 30px;"></div>

      <div style="width: 100%;">
        <h1 class="engagement">Jahresvergleich Tätigkeiten</h1>
        <div style="height: 10px;"></div>
        <div fxLayout="row" fxLayoutAlign="start center">
          <mat-form-field class="matFormField">
            <mat-label>Vergleichsjahr</mat-label>

            <mat-select
              [value]="comparisonYear"
              (selectionChange)="generateComparisonChartData($event.value)"
            >
              <mat-option *ngFor="let year of uniqueYears" [value]="year">{{
                year
              }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div style="width: 50px;"></div>
          <app-share-menu
            class="shareMenu"
            [label]="'Vergleich'"
            (export)="exportChart($event)"
          >
          </app-share-menu>
        </div>

        <div class="chartParrent">
          <ngx-charts-bar-vertical-2d
            [results]="comparisonData"
            [customColors]="colors"
            [animations]="animations"
            [xAxis]="true"
            [yAxis]="true"
            [showXAxisLabel]="true"
            [showYAxisLabel]="true"
            [xAxisLabel]="comparisonXlabel"
            [yAxisLabel]="comparisonYlabel"
            [roundEdges]="false"
            [legend]="true"
            [legendTitle]="Legende"
            [showDataLabel]="true"
            [noBarWhenZero]="false"
          >
          </ngx-charts-bar-vertical-2d>
        </div>
      </div>
    </div>
  </div>

  <p *ngIf="timeout && tenantMap.size === 0" class="alert alert-info">
    <i class="fas fa-exclamation-circle"></i> &nbsp; Noch keiner Organisation
    beigetreten!
  </p>

  <p
    *ngIf="
      timeout && classInstanceDTOs.length === 0 && isLocalRepositoryConnected
    "
    class="alert alert-info"
  >
    <i class="fas fa-exclamation-circle"></i> &nbsp; Es befinden sich noch keine
    Daten in deinem lokalen Freiwilligenpass!
  </p>
</div>
